{"version":3,"file":"bundle.umd.js","sources":["src/utils.js","src/HttpLink.js","src/HttpLinkModule.js"],"sourcesContent":["export var normalizeUrl = function (url) {\n    return url.replace(/^\\/|\\/$/g, '');\n};\nexport var mergeHeaders = function (source, destination) {\n    if (source && destination) {\n        var merged = destination\n            .keys()\n            .reduce(function (headers, name) { return headers.set(name, destination.getAll(name)); }, source);\n        return merged;\n    }\n    return destination || source;\n};\n//# sourceMappingURL=utils.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nimport { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { ApolloLink, Observable } from 'apollo-link';\nimport { print } from 'graphql/language/printer';\nimport { normalizeUrl, mergeHeaders } from './utils';\n// XXX find a better name for it\nvar HttpLinkHandler = /** @class */ (function (_super) {\n    __extends(HttpLinkHandler, _super);\n    function HttpLinkHandler(httpClient, options) {\n        var _this = _super.call(this) || this;\n        _this.options = options;\n        _this.requester = new ApolloLink(function (operation) {\n            return new Observable(function (observer) {\n                var _a = operation.getContext(), headers = _a.headers, withCredentials = _a.withCredentials;\n                var operationName = operation.operationName, variables = operation.variables, query = operation.query, extensions = operation.extensions;\n                var body = {\n                    operationName: operationName,\n                    variables: variables,\n                    query: print(query),\n                };\n                var postOptions = {\n                    withCredentials: _this.options.withCredentials,\n                    headers: _this.options.headers,\n                };\n                if (_this.options.includeExtensions) {\n                    body.extensions = extensions;\n                }\n                if (typeof withCredentials !== 'undefined') {\n                    postOptions.withCredentials = withCredentials;\n                }\n                // merge headers\n                if (headers) {\n                    postOptions.headers = mergeHeaders(postOptions.headers, headers);\n                }\n                var endpointURI = normalizeUrl(_this.options.uri);\n                var defaultURI = 'graphql';\n                var obs = httpClient.post(endpointURI || defaultURI, body, __assign({ observe: 'response', responseType: 'json', reportProgress: false }, postOptions));\n                var sub = obs.subscribe({\n                    next: function (result) {\n                        observer.next(result.body);\n                    },\n                    error: function (err) {\n                        observer.error(err);\n                    },\n                    complete: function () {\n                        observer.complete();\n                    },\n                });\n                return function () {\n                    if (!sub.closed) {\n                        sub.unsubscribe();\n                    }\n                };\n            });\n        }).request;\n        return _this;\n    }\n    HttpLinkHandler.prototype.request = function (op) {\n        return this.requester(op);\n    };\n    return HttpLinkHandler;\n}(ApolloLink));\nexport { HttpLinkHandler };\nvar HttpLink = /** @class */ (function () {\n    function HttpLink(httpClient) {\n        this.httpClient = httpClient;\n    }\n    HttpLink.prototype.create = function (options) {\n        return new HttpLinkHandler(this.httpClient, options);\n    };\n    HttpLink.decorators = [\n        { type: Injectable },\n    ];\n    /** @nocollapse */\n    HttpLink.ctorParameters = function () { return [\n        { type: HttpClient, },\n    ]; };\n    return HttpLink;\n}());\nexport { HttpLink };\n//# sourceMappingURL=HttpLink.js.map","import { NgModule } from '@angular/core';\nimport { HttpLink } from './HttpLink';\nexport var PROVIDERS = [HttpLink];\nvar HttpLinkModule = /** @class */ (function () {\n    function HttpLinkModule() {\n    }\n    HttpLinkModule.decorators = [\n        { type: NgModule, args: [{\n                    providers: PROVIDERS,\n                },] },\n    ];\n    /** @nocollapse */\n    HttpLinkModule.ctorParameters = function () { return []; };\n    return HttpLinkModule;\n}());\nexport { HttpLinkModule };\n//# sourceMappingURL=HttpLinkModule.js.map"],"names":["this","ApolloLink","Observable","print","Injectable","HttpClient","NgModule"],"mappings":"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"}